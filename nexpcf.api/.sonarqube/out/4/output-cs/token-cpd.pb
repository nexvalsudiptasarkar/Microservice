ñÚ
pD:\Project\NexAEI\nexpcf.api.logger\nexpcf.api\nexpcf.api\Core.Consumer.API\Business\AttendanceSummaryManager.cs
	namespace 	
Core
 
. 
Consumer 
. 
API 
. 
Business $
{ 
public 

class $
AttendanceSummaryManager )
:* +

Disposable, 6
{ 
private 
MySqlDataHelper 
sqldatahelper  -
=. /
new0 3
MySqlDataHelper4 C
(C D
)D E
;E F
public 
MySqlConnection 
DataConn '
=( )
new* -
MySqlConnection. =
(= >
)> ?
;? @
private 
readonly 
ILogger  
_logger! (
;( )
	protected 
override 
void 
cleanup  '
(' (
)( )
{* +
}, -
public $
AttendanceSummaryManager '
(' (
ILogger( /
logger0 6
)6 7
{ 	
_logger 
= 
logger 
; 
} 	
public $
AttendanceSummaryManager '
(' (
IConfiguration( 6
configuration7 D
,D E
ILoggerF M
loggerN T
)T U
{   	
Configuration!! 
=!! 
configuration!! )
;!!) *
}"" 	
public$$ 
IConfiguration$$ 
Configuration$$ +
{$$, -
get$$. 1
;$$1 2
}$$3 4
public&& 
async&& 
Task&& %
generateAttendanceSummary&& 3
(&&3 4

SummaryRef&&4 >
obj&&? B
)&&B C
{'' 	
try(( 
{)) 
String** 
env** 
=** 
$str** "
;**" #
MySqlParameter++ 
[++ 
]++  
parameterAttn++! .
=++/ 0
Util++1 5
.++5 6
GetParameter++6 B
(++B C
obj++C F
)++F G
;++G H
if.. 
(.. 
obj.. 
... 
objectid..  
>..! "
$num..# $
)..$ %
{// 
var11 
resultSummary11 %
=11& '
await11( -
this11. 2
.112 3
sqldatahelper113 @
.11@ A
ExecuteDataSet11A O
(11O P
Util11P T
.11T U
CS11U W
(11W X
env11X [
)11[ \
,11\ ]
Constant11^ f
.11f g+
nex_re_gen_delta_modified_data	11g Ö
,
11Ö Ü
CommandType
11á í
.
11í ì
StoredProcedure
11ì ¢
,
11¢ £
parameterAttn
11§ ±
,
11± ≤
_logger
11≥ ∫
)
11∫ ª
.
11ª º
ToListAsync
11º «
<
11« »
SummaryResult
11» ’
>
11’ ÷
(
11÷ ◊
)
11◊ ÿ
;
11ÿ Ÿ
List22 
<22 
SummaryResult22 &
>22& '
resultSummaryLstObj22( ;
=22< =
new22> A
List22B F
<22F G
SummaryResult22G T
>22T U
(22U V
)22V W
;22W X
resultSummaryLstObj33 '
.33' (
AddRange33( 0
(330 1
resultSummary331 >
)33> ?
;33? @
SummaryResult55 !

summaryObj55" ,
=55- .
resultSummaryLstObj55/ B
[55B C
$num55C D
]55D E
;55E F
SummaryParameter77 $
param77% *
=77+ ,
new77- 0
SummaryParameter771 A
(77A B
)77B C
;77C D
Util99 
.99 
CopyPropertiesFrom99 +
(99+ ,
param99, 1
,991 2

summaryObj993 =
)99= >
;99> ?
MySqlParameter;; "
[;;" #
];;# $ 
parameterAttnSummary;;% 9
=;;: ;
Util;;< @
.;;@ A
GetParameter;;A M
(;;M N
param;;N S
);;S T
;;;T U
await== 
this== 
.== 
sqldatahelper== ,
.==, -
ExecuteNonQuery==- <
(==< =
Util=== A
.==A B
CS==B D
(==D E
env==E H
)==H I
,==I J
Constant==K S
.==S T&
nex_save_attendance_status==T n
,==n o
CommandType==p {
.=={ |
StoredProcedure	==| ã
,
==ã å"
parameterAttnSummary
==ç °
,
==° ¢
_logger
==£ ™
)
==™ ´
;
==´ ¨
}>> 
}?? 
catch@@ 
(@@ 
	Exception@@ 
e@@ 
)@@ 
{AA 
_loggerBB 
.BB 
LogErrorBB  
(BB  !
stringBB! '
.BB' (
FormatBB( .
(BB. /
$strBB/ B
,BBB C
thisBBD H
.BBH I
GetTypeBBI P
(BBP Q
)BBQ R
.BBR S
NameBBS W
,BBW X
SystemBBY _
.BB_ `

ReflectionBB` j
.BBj k

MethodBaseBBk u
.BBu v
GetCurrentMethod	BBv Ü
(
BBÜ á
)
BBá à
.
BBà â
Name
BBâ ç
,
BBç é
$str
BBè π
)
BBπ ∫
)
BB∫ ª
;
BBª º
throwCC 
eCC 
;CC 
}DD 
}EE 	
publicFF 
asyncFF 
TaskFF 0
$generateAttendanceSummaryAutoProcessFF >
(FF> ?
)FF? @
{GG 	
_loggerHH 
.HH 
LogInformationHH "
(HH" #
stringHH# )
.HH) *
FormatHH* 0
(HH0 1
$strHH1 D
,HHD E
thisHHF J
.HHJ K
GetTypeHHK R
(HHR S
)HHS T
.HHT U
NameHHU Y
,HHY Z
SystemHH[ a
.HHa b

ReflectionHHb l
.HHl m

MethodBaseHHm w
.HHw x
GetCurrentMethod	HHx à
(
HHà â
)
HHâ ä
.
HHä ã
Name
HHã è
,
HHè ê
$str
HHë õ
)
HHõ ú
)
HHú ù
;
HHù û
tryJJ 
{KK 
DateTimeLL 
fromdateLL !
=LL" #
newLL$ '
DateTimeLL( 0
(LL0 1
$numLL1 5
,LL5 6
$numLL7 9
,LL9 :
$numLL; =
)LL= >
;LL> ?
DateTimeMM 
todateMM 
=MM  !
newMM" %
DateTimeMM& .
(MM. /
$numMM/ 3
,MM3 4
$numMM5 7
,MM7 8
$numMM9 ;
)MM; <
;MM< =
DateTimeNN 
startdatetmpNN %
=NN& '
newNN( +
DateTimeNN, 4
(NN4 5
)NN5 6
;NN6 7
startdatetmpOO 
=OO 
fromdateOO '
;OO' (
stringPP 
envPP 
=PP 
$strPP #
;PP# $
whileQQ 
(QQ 
startdatetmpQQ #
<=QQ$ &
todateQQ' -
)QQ- .
{RR 
trySS 
{TT 
_loggerUU 
.UU  
LogInformationUU  .
(UU. /
stringUU/ 5
.UU5 6
FormatUU6 <
(UU< =
$strUU= x
,UUx y
thisVV  
.VV  !
GetTypeVV! (
(VV( )
)VV) *
.VV* +
NameVV+ /
,VV/ 0
SystemVV1 7
.VV7 8

ReflectionVV8 B
.VVB C

MethodBaseVVC M
.VVM N
GetCurrentMethodVVN ^
(VV^ _
)VV_ `
.VV` a
NameVVa e
,VVe f
startdatetmpWW (
,WW( )
DateTimeWW* 2
.WW2 3
NowWW3 6
)WW6 7
)WW7 8
;WW8 9
AttendanceSummaryXX )
objXX* -
=XX. /
newXX0 3
AttendanceSummaryXX4 E
(XXE F
)XXF G
;XXG H
MySqlParameterZZ &
[ZZ& '
]ZZ' (
	parameterZZ) 2
=ZZ3 4
UtilZZ5 9
.ZZ9 :
GetParameterZZ: F
(ZZF G
objZZG J
)ZZJ K
;ZZK L
_logger[[ 
.[[  
LogInformation[[  .
([[. /
string[[/ 5
.[[5 6
Format[[6 <
([[< =
$str[[= m
,[[m n
this\\  
.\\  !
GetType\\! (
(\\( )
)\\) *
.\\* +
Name\\+ /
,\\/ 0
System\\1 7
.\\7 8

Reflection\\8 B
.\\B C

MethodBase\\C M
.\\M N
GetCurrentMethod\\N ^
(\\^ _
)\\_ `
.\\` a
Name\\a e
,\\e f
DateTime]] $
.]]$ %
Now]]% (
)]]( )
)]]) *
;]]* +
var^^ 
	orgobject^^ %
=^^& '
await^^( -
this^^. 2
.^^2 3
sqldatahelper^^3 @
.^^@ A
ExecuteDataSet^^A O
(^^O P
Util^^P T
.^^T U
CS^^U W
(^^W X
env^^X [
)^^[ \
,^^\ ]
Constant^^^ f
.^^f g
nex_get_orgs^^g s
,^^s t
CommandType	^^u Ä
.
^^Ä Å
StoredProcedure
^^Å ê
,
^^ê ë
	parameter
^^í õ
,
^^õ ú
_logger
^^ù §
)
^^§ •
.
^^• ¶
ToListAsync
^^¶ ±
<
^^± ≤
Organization
^^≤ æ
>
^^æ ø
(
^^ø ¿
)
^^¿ ¡
;
^^¡ ¬
_logger__ 
.__  
LogInformation__  .
(__. /
string__/ 5
.__5 6
Format__6 <
(__< =
$str__= k
,__k l
this``  
.``  !
GetType``! (
(``( )
)``) *
.``* +
Name``+ /
,``/ 0
System``1 7
.``7 8

Reflection``8 B
.``B C

MethodBase``C M
.``M N
GetCurrentMethod``N ^
(``^ _
)``_ `
.``` a
Name``a e
,``e f
DateTimeaa $
.aa$ %
Nowaa% (
)aa( )
)aa) *
;aa* +
Listbb 
<bb 
Organizationbb )
>bb) *
orglistbb+ 2
=bb3 4
newbb5 8
Listbb9 =
<bb= >
Organizationbb> J
>bbJ K
(bbK L
)bbL M
;bbM N
orglistcc 
.cc  
AddRangecc  (
(cc( )
	orgobjectcc) 2
)cc2 3
;cc3 4
foreachee 
(ee  !
varee! $

eachorgobjee% /
inee0 2
orglistee3 :
)ee: ;
{ff 
OrganizationParamgg -

objorgusergg. 8
=gg9 :
newgg; >
OrganizationParamgg? P
(ggP Q
)ggQ R
;ggR S

objorguserhh &
.hh& '
in_orgidhh' /
=hh0 1

eachorgobjhh2 <
.hh< =
OrgIDhh= B
;hhB C
MySqlParameterii *
[ii* +
]ii+ ,
parameteruserii- :
=ii; <
Utilii= A
.iiA B
GetParameteriiB N
(iiN O

objorguseriiO Y
)iiY Z
;iiZ [
_loggerkk #
.kk# $
LogInformationkk$ 2
(kk2 3
$strkk3 W
,kkW X
thiskkY ]
.kk] ^
GetTypekk^ e
(kke f
)kkf g
.kkg h
Namekkh l
,kkl m
Systemkkn t
.kkt u

Reflectionkku 
.	kk Ä

MethodBase
kkÄ ä
.
kkä ã
GetCurrentMethod
kkã õ
(
kkõ ú
)
kkú ù
.
kkù û
Name
kkû ¢
)
kk¢ £
;
kk£ §
_loggerll #
.ll# $
LogInformationll$ 2
(ll2 3
stringll3 9
.ll9 :
Formatll: @
(ll@ A
$str	llA à
,
llà â
thismm  $
.mm$ %
GetTypemm% ,
(mm, -
)mm- .
.mm. /
Namemm/ 3
,mm3 4
Systemmm5 ;
.mm; <

Reflectionmm< F
.mmF G

MethodBasemmG Q
.mmQ R
GetCurrentMethodmmR b
(mmb c
)mmc d
.mmd e
Namemme i
,mmi j

objorgusernn  *
.nn* +
in_orgidnn+ 3
,nn3 4
startdatetmpnn5 A
,nnA B
DateTimennC K
.nnK L
NownnL O
)nnO P
)nnP Q
;nnQ R
_loggerpp #
.pp# $
LogInformationpp$ 2
(pp2 3
stringpp3 9
.pp9 :
Formatpp: @
(pp@ A
$strppA |
,pp| }
thisqq  $
.qq$ %
GetTypeqq% ,
(qq, -
)qq- .
.qq. /
Nameqq/ 3
,qq3 4
Systemqq5 ;
.qq; <

Reflectionqq< F
.qqF G

MethodBaseqqG Q
.qqQ R
GetCurrentMethodqqR b
(qqb c
)qqc d
.qqd e
Nameqqe i
,rr$ %

objorguserrr& 0
.rr0 1
in_orgidrr1 9
,rr9 :
DateTimerr; C
.rrC D
NowrrD G
)rrG H
)rrH I
;rrI J
varss 
orguserlistobjss  .
=ss/ 0
awaitss1 6
thisss7 ;
.ss; <
sqldatahelperss< I
.ssI J
ExecuteDataSetssJ X
(ssX Y
UtilssY ]
.ss] ^
CSss^ `
(ss` a
envssa d
)ssd e
,sse f
Constantssg o
.sso p
nex_get_orgs_users	ssp Ç
,
ssÇ É
CommandType
ssÑ è
.
ssè ê
StoredProcedure
ssê ü
,
ssü †
parameteruser
ss° Æ
,
ssÆ Ø
_logger
ss∞ ∑
)
ss∑ ∏
.
ss∏ π
ToListAsync
ssπ ƒ
<
ssƒ ≈
Users
ss≈  
>
ss  À
(
ssÀ Ã
)
ssÃ Õ
;
ssÕ Œ
_loggertt #
.tt# $
LogInformationtt$ 2
(tt2 3
stringtt3 9
.tt9 :
Formattt: @
(tt@ A
$strttA z
,ttz {
thisuu  $
.uu$ %
GetTypeuu% ,
(uu, -
)uu- .
.uu. /
Nameuu/ 3
,uu3 4
Systemuu5 ;
.uu; <

Reflectionuu< F
.uuF G

MethodBaseuuG Q
.uuQ R
GetCurrentMethoduuR b
(uub c
)uuc d
.uud e
Nameuue i
,vv$ %

objorguservv& 0
.vv0 1
in_orgidvv1 9
,vv9 :
DateTimevv; C
.vvC D
NowvvD G
)vvG H
)vvH I
;vvI J
Listww  
<ww  !
Usersww! &
>ww& '
userlistww( 0
=ww1 2
newww3 6
Listww7 ;
<ww; <
Usersww< A
>wwA B
(wwB C
)wwC D
;wwD E
userlistxx $
.xx$ %
AddRangexx% -
(xx- .
orguserlistobjxx. <
)xx< =
;xx= >
foreachyy #
(yy$ %
varyy% (
eachUserObjyy) 4
inyy5 7
userlistyy8 @
)yy@ A
{zz 
AttendanceSummary{{  1
objatten{{2 :
={{; <
new{{= @
AttendanceSummary{{A R
({{R S
){{S T
;{{T U
objatten||  (
.||( )
in_attendancedate||) :
=||; <
startdatetmp||= I
;||I J
objatten}}  (
.}}( )
	in_userid}}) 2
=}}3 4
eachUserObj}}5 @
.}}@ A
UserID}}A G
;}}G H
try~~  #
{  !
MySqlParameter
ÄÄ$ 2
[
ÄÄ2 3
]
ÄÄ3 4
parameterAttn
ÄÄ5 B
=
ÄÄC D
Util
ÄÄE I
.
ÄÄI J
GetParameter
ÄÄJ V
(
ÄÄV W
objatten
ÄÄW _
)
ÄÄ_ `
;
ÄÄ` a
_logger
ÇÇ$ +
.
ÇÇ+ ,
LogInformation
ÇÇ, :
(
ÇÇ: ;
$str
ÇÇ; J
)
ÇÇJ K
;
ÇÇK L
_logger
ÉÉ$ +
.
ÉÉ+ ,
LogInformation
ÉÉ, :
(
ÉÉ: ;
string
ÉÉ; A
.
ÉÉA B
Format
ÉÉB H
(
ÉÉH I
$strÉÉI õ
,ÉÉõ ú
this
ÑÑ$ (
.
ÑÑ( )
GetType
ÑÑ) 0
(
ÑÑ0 1
)
ÑÑ1 2
.
ÑÑ2 3
Name
ÑÑ3 7
,
ÑÑ7 8
System
ÑÑ9 ?
.
ÑÑ? @

Reflection
ÑÑ@ J
.
ÑÑJ K

MethodBase
ÑÑK U
.
ÑÑU V
GetCurrentMethod
ÑÑV f
(
ÑÑf g
)
ÑÑg h
.
ÑÑh i
Name
ÑÑi m
,
ÖÖ( )
objatten
ÖÖ* 2
.
ÖÖ2 3
	in_userid
ÖÖ3 <
,
ÖÖ< =

objorguser
ÖÖ> H
.
ÖÖH I
in_orgid
ÖÖI Q
,
ÖÖQ R
startdatetmp
ÖÖS _
,
ÖÖ_ `
DateTime
ÖÖa i
.
ÖÖi j
Now
ÖÖj m
)
ÖÖm n
)
ÖÖn o
;
ÖÖo p
_logger
àà$ +
.
àà+ ,
LogInformation
àà, :
(
àà: ;
string
àà; A
.
ààA B
Format
ààB H
(
ààH I
$strààI ß
,ààß ®
this
ââ( ,
.
ââ, -
GetType
ââ- 4
(
ââ4 5
)
ââ5 6
.
ââ6 7
Name
ââ7 ;
,
ââ; <
System
ââ= C
.
ââC D

Reflection
ââD N
.
ââN O

MethodBase
ââO Y
.
ââY Z
GetCurrentMethod
ââZ j
(
ââj k
)
ââk l
.
ââl m
Name
ââm q
,
ää$ %
objatten
ää& .
.
ää. /
	in_userid
ää/ 8
,
ää8 9

objorguser
ää: D
.
ääD E
in_orgid
ääE M
,
ääM N
startdatetmp
ääO [
,
ää[ \
DateTime
ää] e
.
ääe f
Now
ääf i
)
ääi j
)
ääj k
;
ääk l
var
ãã$ '
resultSummary
ãã( 5
=
ãã6 7
await
ãã8 =
this
ãã> B
.
ããB C
sqldatahelper
ããC P
.
ããP Q
ExecuteDataSet
ããQ _
(
ãã_ `
Util
ãã` d
.
ããd e
CS
ããe g
(
ããg h
env
ããh k
)
ããk l
,
ããl m
Constant
ããn v
.
ããv w-
nex_generate_attendance_statusããw ï
,ããï ñ
CommandTypeããó ¢
.ãã¢ £
StoredProcedureãã£ ≤
,ãã≤ ≥
parameterAttnãã¥ ¡
,ãã¡ ¬
_loggerãã√  
)ãã  À
.ããÀ Ã
ToListAsyncããÃ ◊
<ãã◊ ÿ
SummaryResultããÿ Â
>ããÂ Ê
(ããÊ Á
)ããÁ Ë
;ããË È
_logger
åå$ +
.
åå+ ,
LogInformation
åå, :
(
åå: ;
string
åå; A
.
ååA B
Format
ååB H
(
ååH I
$strååI •
,åå• ¶
this
çç$ (
.
çç( )
GetType
çç) 0
(
çç0 1
)
çç1 2
.
çç2 3
Name
çç3 7
,
çç7 8
System
çç9 ?
.
çç? @

Reflection
çç@ J
.
ççJ K

MethodBase
ççK U
.
ççU V
GetCurrentMethod
ççV f
(
ççf g
)
ççg h
.
ççh i
Name
ççi m
,
éé( )
objatten
éé* 2
.
éé2 3
	in_userid
éé3 <
,
éé< =

objorguser
éé> H
.
ééH I
in_orgid
ééI Q
,
ééQ R
startdatetmp
ééS _
,
éé_ `
DateTime
ééa i
.
ééi j
Now
ééj m
)
éém n
)
één o
;
ééo p
List
ëë$ (
<
ëë( )
SummaryResult
ëë) 6
>
ëë6 7!
resultSummaryLstObj
ëë8 K
=
ëëL M
new
ëëN Q
List
ëëR V
<
ëëV W
SummaryResult
ëëW d
>
ëëd e
(
ëëe f
)
ëëf g
;
ëëg h!
resultSummaryLstObj
íí$ 7
.
íí7 8
AddRange
íí8 @
(
íí@ A
resultSummary
ííA N
)
ííN O
;
ííO P
SummaryResult
îî$ 1

summaryObj
îî2 <
=
îî= >!
resultSummaryLstObj
îî? R
[
îîR S
$num
îîS T
]
îîT U
;
îîU V
if
ïï$ &
(
ïï' (

summaryObj
ïï( 2
.
ïï2 3

attnstatus
ïï3 =
!=
ïï> @
$str
ïïA C
)
ïïC D
{
ññ$ %
SummaryParameter
óó( 8
param
óó9 >
=
óó? @
new
óóA D
SummaryParameter
óóE U
(
óóU V
)
óóV W
;
óóW X
Util
ôô( ,
.
ôô, - 
CopyPropertiesFrom
ôô- ?
(
ôô? @
param
ôô@ E
,
ôôE F

summaryObj
ôôG Q
)
ôôQ R
;
ôôR S
MySqlParameter
õõ( 6
[
õõ6 7
]
õõ7 8"
parameterAttnSummary
õõ9 M
=
õõN O
Util
õõP T
.
õõT U
GetParameter
õõU a
(
õõa b
param
õõb g
)
õõg h
;
õõh i
_logger
úú( /
.
úú/ 0
LogInformation
úú0 >
(
úú> ?
string
úú? E
.
úúE F
Format
úúF L
(
úúL M
$strúúM º
,úúº Ω
this
ùù( ,
.
ùù, -
GetType
ùù- 4
(
ùù4 5
)
ùù5 6
.
ùù6 7
Name
ùù7 ;
,
ùù; <
System
ùù= C
.
ùùC D

Reflection
ùùD N
.
ùùN O

MethodBase
ùùO Y
.
ùùY Z
GetCurrentMethod
ùùZ j
(
ùùj k
)
ùùk l
.
ùùl m
Name
ùùm q
,
ûû, -
objatten
ûû. 6
.
ûû6 7
	in_userid
ûû7 @
,
ûû@ A

objorguser
ûûB L
.
ûûL M
in_orgid
ûûM U
,
ûûU V
startdatetmp
ûûW c
,
ûûc d
DateTime
ûûe m
.
ûûm n
Now
ûûn q
)
ûûq r
)
ûûr s
;
ûûs t
await
üü( -
this
üü. 2
.
üü2 3
sqldatahelper
üü3 @
.
üü@ A
ExecuteNonQuery
üüA P
(
üüP Q
Util
üüQ U
.
üüU V
CS
üüV X
(
üüX Y
env
üüY \
)
üü\ ]
,
üü] ^
Constant
üü_ g
.
üüg h)
nex_save_attendance_statusüüh Ç
,üüÇ É
CommandTypeüüÑ è
.üüè ê
StoredProcedureüüê ü
,üüü †$
parameterAttnSummaryüü° µ
,üüµ ∂
_loggerüü∑ æ
)üüæ ø
;üüø ¿
_logger
††( /
.
††/ 0
LogInformation
††0 >
(
††> ?
string
††? E
.
††E F
Format
††F L
(
††L M
$str††M ∫
,††∫ ª
this
°°( ,
.
°°, -
GetType
°°- 4
(
°°4 5
)
°°5 6
.
°°6 7
Name
°°7 ;
,
°°; <
System
°°= C
.
°°C D

Reflection
°°D N
.
°°N O

MethodBase
°°O Y
.
°°Y Z
GetCurrentMethod
°°Z j
(
°°j k
)
°°k l
.
°°l m
Name
°°m q
,
¢¢, -
objatten
¢¢. 6
.
¢¢6 7
	in_userid
¢¢7 @
,
¢¢@ A

objorguser
¢¢B L
.
¢¢L M
in_orgid
¢¢M U
,
¢¢U V
startdatetmp
¢¢W c
,
¢¢c d
DateTime
¢¢e m
.
¢¢m n
Now
¢¢n q
)
¢¢q r
)
¢¢r s
;
¢¢s t
}
££$ %
_logger
••$ +
.
••+ ,
LogInformation
••, :
(
••: ;
string
••; A
.
••A B
Format
••B H
(
••H I
$str••I ô
,••ô ö
this
¶¶( ,
.
¶¶, -
GetType
¶¶- 4
(
¶¶4 5
)
¶¶5 6
.
¶¶6 7
Name
¶¶7 ;
,
¶¶; <
System
¶¶= C
.
¶¶C D

Reflection
¶¶D N
.
¶¶N O

MethodBase
¶¶O Y
.
¶¶Y Z
GetCurrentMethod
¶¶Z j
(
¶¶j k
)
¶¶k l
.
¶¶l m
Name
¶¶m q
,
ßß$ %
objatten
ßß& .
.
ßß. /
	in_userid
ßß/ 8
,
ßß8 9

objorguser
ßß: D
.
ßßD E
in_orgid
ßßE M
,
ßßM N
startdatetmp
ßßO [
,
ßß[ \
DateTime
ßß] e
.
ßße f
Now
ßßf i
)
ßßi j
)
ßßj k
;
ßßk l
_logger
©©$ +
.
©©+ ,
LogInformation
©©, :
(
©©: ;
string
©©; A
.
©©A B
Format
©©B H
(
©©H I
$str©©I õ
,©©õ ú
this
™™( ,
.
™™, -
GetType
™™- 4
(
™™4 5
)
™™5 6
.
™™6 7
Name
™™7 ;
,
™™; <
System
™™= C
.
™™C D

Reflection
™™D N
.
™™N O

MethodBase
™™O Y
.
™™Y Z
GetCurrentMethod
™™Z j
(
™™j k
)
™™k l
.
™™l m
Name
™™m q
,
´´$ %
objatten
´´& .
.
´´. /
	in_userid
´´/ 8
,
´´8 9

objorguser
´´: D
.
´´D E
in_orgid
´´E M
,
´´M N
startdatetmp
´´O [
,
´´[ \
DateTime
´´] e
.
´´e f
Now
´´f i
)
´´i j
)
´´j k
;
´´k l
_logger
¨¨$ +
.
¨¨+ ,
LogInformation
¨¨, :
(
¨¨: ;
$str
¨¨; J
)
¨¨J K
;
¨¨K L
}
≠≠  !
catch
ÆÆ  %
(
ÆÆ& '
	Exception
ÆÆ' 0
e
ÆÆ1 2
)
ÆÆ2 3
{
ØØ  !
_logger
∞∞$ +
.
∞∞+ ,
LogError
∞∞, 4
(
∞∞4 5
string
∞∞5 ;
.
∞∞; <
Format
∞∞< B
(
∞∞B C
$str∞∞C ã
,∞∞ã å
this
±±( ,
.
±±, -
GetType
±±- 4
(
±±4 5
)
±±5 6
.
±±6 7
Name
±±7 ;
,
±±; <
System
±±= C
.
±±C D

Reflection
±±D N
.
±±N O

MethodBase
±±O Y
.
±±Y Z
GetCurrentMethod
±±Z j
(
±±j k
)
±±k l
.
±±l m
Name
±±m q
,
≤≤$ %
objatten
≤≤& .
.
≤≤. /
	in_userid
≤≤/ 8
,
≤≤8 9

objorguser
≤≤: D
.
≤≤D E
in_orgid
≤≤E M
,
≤≤M N
startdatetmp
≤≤O [
,
≤≤[ \
DateTime
≤≤] e
.
≤≤e f
Now
≤≤f i
)
≤≤i j
)
≤≤j k
;
≤≤k l
}
≥≥  !
}
¥¥ 
_logger
µµ #
.
µµ# $
LogInformation
µµ$ 2
(
µµ2 3
string
µµ3 9
.
µµ9 :
Format
µµ: @
(
µµ@ A
$strµµA Ü
,µµÜ á
this
∂∂  $
.
∂∂$ %
GetType
∂∂% ,
(
∂∂, -
)
∂∂- .
.
∂∂. /
Name
∂∂/ 3
,
∂∂3 4
System
∂∂5 ;
.
∂∂; <

Reflection
∂∂< F
.
∂∂F G

MethodBase
∂∂G Q
.
∂∂Q R
GetCurrentMethod
∂∂R b
(
∂∂b c
)
∂∂c d
.
∂∂d e
Name
∂∂e i
,
∑∑  !

objorguser
∑∑" ,
.
∑∑, -
in_orgid
∑∑- 5
,
∑∑5 6
startdatetmp
∑∑7 C
,
∑∑C D
DateTime
∑∑E M
.
∑∑M N
Now
∑∑N Q
)
∑∑Q R
)
∑∑R S
;
∑∑S T
_logger
∏∏ #
.
∏∏# $
LogInformation
∏∏$ 2
(
∏∏2 3
$str
∏∏3 U
,
∏∏U V
this
∏∏W [
.
∏∏[ \
GetType
∏∏\ c
(
∏∏c d
)
∏∏d e
.
∏∏e f
Name
∏∏f j
,
∏∏j k
System
∏∏l r
.
∏∏r s

Reflection
∏∏s }
.
∏∏} ~

MethodBase∏∏~ à
.∏∏à â 
GetCurrentMethod∏∏â ô
(∏∏ô ö
)∏∏ö õ
.∏∏õ ú
Name∏∏ú †
)∏∏† °
;∏∏° ¢
}
ππ 
_logger
∫∫ 
.
∫∫  
LogInformation
∫∫  .
(
∫∫. /
string
∫∫/ 5
.
∫∫5 6
Format
∫∫6 <
(
∫∫< =
$str
∫∫= v
,
∫∫v w
this
ªª  
.
ªª  !
GetType
ªª! (
(
ªª( )
)
ªª) *
.
ªª* +
Name
ªª+ /
,
ªª/ 0
System
ªª1 7
.
ªª7 8

Reflection
ªª8 B
.
ªªB C

MethodBase
ªªC M
.
ªªM N
GetCurrentMethod
ªªN ^
(
ªª^ _
)
ªª_ `
.
ªª` a
Name
ªªa e
,
ªªe f
startdatetmp
ºº (
,
ºº( )
DateTime
ºº* 2
.
ºº2 3
Now
ºº3 6
)
ºº6 7
)
ºº7 8
;
ºº8 9
}
ææ 
catch
øø 
(
øø 
	Exception
øø $
e
øø% &
)
øø& '
{
¿¿ 
_logger
¡¡ 
.
¡¡  
LogCritical
¡¡  +
(
¡¡+ ,
string
¡¡, 2
.
¡¡2 3
Format
¡¡3 9
(
¡¡9 :
$str¡¡: â
,¡¡â ä
this
¬¬ 
.
¬¬ 
GetType
¬¬ $
(
¬¬$ %
)
¬¬% &
.
¬¬& '
Name
¬¬' +
,
¬¬+ ,
System
¬¬- 3
.
¬¬3 4

Reflection
¬¬4 >
.
¬¬> ?

MethodBase
¬¬? I
.
¬¬I J
GetCurrentMethod
¬¬J Z
(
¬¬Z [
)
¬¬[ \
.
¬¬\ ]
Name
¬¬] a
,
√√ 
startdatetmp
√√ *
,
√√* +
DateTime
√√, 4
.
√√4 5
Now
√√5 8
,
√√8 9
e
√√: ;
.
√√; <
Message
√√< C
)
√√C D
)
√√D E
;
√√E F
}
ƒƒ 
finally
≈≈ 
{
∆∆ 
startdatetmp
«« $
=
««% &
startdatetmp
««' 3
.
««3 4
AddDays
««4 ;
(
««; <
$num
««< =
)
««= >
;
««> ?
}
»» 
}
   
}
ÃÃ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
e
ÕÕ 
)
ÕÕ 
{
ŒŒ 
_logger
œœ 
.
œœ 
LogCritical
œœ #
(
œœ# $
string
œœ$ *
.
œœ* +
Format
œœ+ 1
(
œœ1 2
$str
œœ2 _
,
œœ_ `
this
–– 
.
–– 
GetType
––  
(
––  !
)
––! "
.
––" #
Name
––# '
,
––' (
System
––) /
.
––/ 0

Reflection
––0 :
.
––: ;

MethodBase
––; E
.
––E F
GetCurrentMethod
––F V
(
––V W
)
––W X
.
––X Y
Name
––Y ]
,
—— 
DateTime
—— 
.
—— 
Now
—— 
)
—— 
)
——  
;
——  !
throw
”” 
e
”” 
;
”” 
}
‘‘ 
}
’’ 	
}
÷÷ 
}◊◊ Å
bD:\Project\NexAEI\nexpcf.api.logger\nexpcf.api\nexpcf.api\Core.Consumer.API\Business\Disposable.cs
	namespace 	
Core
 
. 
Consumer 
. 
API 
. 
Business $
{ 
public 

abstract 
class 

Disposable $
:% &
IDisposable' 2
{		 
	protected 
bool 
	_disposed  
;  !
	protected 

Disposable 
( 
) 
{ 	
this 
. 
	_disposed 
= 
false "
;" #
} 	
public 
static 
void 
SafeDispose &
<& '
T' (
>( )
() *
ref* -
T. /
objectToDispose0 ?
)? @
whereA F
TG H
:I J
classK P
,P Q
IDisposableR ]
{ 	
if 
( 
objectToDispose 
!=  "
null# '
)' (
{ 
objectToDispose 
.  
Dispose  '
(' (
)( )
;) *
objectToDispose 
=  !
null" &
;& '
}   
}!! 	
public$$ 
void$$ 
Dispose$$ 
($$ 
)$$ 
{%% 	
Dispose&& 
(&& 
true&& 
)&& 
;&& 
GC'' 
.'' 
SuppressFinalize'' 
(''  
this''  $
)''$ %
;''% &
}(( 	
private** 
void** 
Dispose** 
(** 
bool** !
	disposing**" +
)**+ ,
{++ 	
if-- 
(-- 
!-- 
this-- 
.-- 
	_disposed-- 
)--  
{.. 
if11 
(11 
	disposing11 
)11 
{22 
cleanup33 
(33 
)33 
;33 
}44 
}55 
this66 
.66 
	_disposed66 
=66 
true66 !
;66! "
}77 	
	protected;; 
abstract;; 
void;; 
cleanup;;  '
(;;' (
);;( )
;;;) *
}== 
}>> Öm
lD:\Project\NexAEI\nexpcf.api.logger\nexpcf.api\nexpcf.api\Core.Consumer.API\Business\EarlyCheckOutManager.cs
	namespace 	
Core
 
. 
Consumer 
. 
API 
. 
Business $
{ 
class 	 
EarlyCheckOutManager
 
:  

Disposable! +
{ 
private 
MySqlDataHelper 
sqldatahelper  -
=. /
new0 3
MySqlDataHelper4 C
(C D
)D E
;E F
public 
MySqlConnection 
DataConn '
=( )
new* -
MySqlConnection. =
(= >
)> ?
;? @
	protected 
override 
void 
cleanup  '
(' (
)( )
{* +
}, -
private 
readonly 
ILogger  
_logger! (
;( )
public  
EarlyCheckOutManager #
(# $
ILogger$ +
logger, 2
)2 3
{ 	
_logger 
= 
logger 
; 
} 	
public  
EarlyCheckOutManager #
(# $
IConfiguration$ 2
configuration3 @
)@ A
{ 	
Configuration 
= 
configuration )
;) *
} 	
public   
IConfiguration   
Configuration   +
{  , -
get  . 1
;  1 2
}  3 4
public!! 
async!! 
Task!!  
processEarlyCheckOut!! .
(!!. /
)!!/ 0
{"" 	
try## 
{$$ 
string%% 
env%% 
=%% 
$str%% #
;%%# $
EarlyCheckOut'' 
obj'' !
=''" #
new''$ '
EarlyCheckOut''( 5
(''5 6
)''6 7
;''7 8
AttendanceSummary(( !
objattn((" )
=((* +
new((, /
AttendanceSummary((0 A
(((A B
)((B C
;((C D
obj)) 
.)) 
in_attendancedate)) %
=))& '
new))( +
DateTime)), 4
())4 5
$num))5 9
,))9 :
$num)): <
,))< =
$num))= ?
)))? @
.))@ A
AddDays))A H
())H I
-))I J
$num))J K
)))K L
;))L M
objattn** 
.** 
in_attendancedate** )
=*** +
new**, /
DateTime**0 8
(**8 9
$num**9 =
,**= >
$num**? A
,**A B
$num**C E
)**E F
.**F G
AddDays**G N
(**N O
-**O P
$num**P Q
)**Q R
;**R S
objattn++ 
.++ 
	in_userid++ !
=++" #
$num++$ %
;++% &
MySqlParameter,, 
[,, 
],,  
	parameter,,! *
=,,+ ,
Util,,- 1
.,,1 2
GetParameter,,2 >
(,,> ?
objattn,,? F
),,F G
;,,G H
_logger-- 
.-- 
LogInformation-- &
(--& '
string--' -
.--- .
Format--. 4
(--4 5
$str--5 e
,--e f
this.. 
... 
GetType..  
(..  !
)..! "
..." #
Name..# '
,..' (
System..) /
.../ 0

Reflection..0 :
...: ;

MethodBase..; E
...E F
GetCurrentMethod..F V
(..V W
)..W X
...X Y
Name..Y ]
,..] ^
DateTime// 
.// 
Now//  
)//  !
)//! "
;//" #
var00 
	orgobject00 
=00 
await00  %
this00& *
.00* +
sqldatahelper00+ 8
.008 9
ExecuteDataSet009 G
(00G H
Util00H L
.00L M
CS00M O
(00O P
env00P S
)00S T
,00T U
Constant00V ^
.00^ _
nex_get_orgs00_ k
,00k l
CommandType00m x
.00x y
StoredProcedure	00y à
,
00à â
	parameter
00ä ì
,
00ì î
_logger
00ï ú
)
00ú ù
.
00ù û
ToListAsync
00û ©
<
00© ™
Organization
00™ ∂
>
00∂ ∑
(
00∑ ∏
)
00∏ π
;
00π ∫
_logger11 
.11 
LogInformation11 &
(11& '
string11' -
.11- .
Format11. 4
(114 5
$str115 c
,11c d
this22 
.22 
GetType22  
(22  !
)22! "
.22" #
Name22# '
,22' (
System22) /
.22/ 0

Reflection220 :
.22: ;

MethodBase22; E
.22E F
GetCurrentMethod22F V
(22V W
)22W X
.22X Y
Name22Y ]
,22] ^
DateTime33 
.33 
Now33  
)33  !
)33! "
;33" #
List44 
<44 
Organization44 !
>44! "
orglist44# *
=44+ ,
new44- 0
List441 5
<445 6
Organization446 B
>44B C
(44C D
)44D E
;44E F
orglist55 
.55 
AddRange55  
(55  !
	orgobject55! *
)55* +
;55+ ,
foreach88 
(88 
var88 

eachorgobj88 '
in88( *
orglist88+ 2
)882 3
{99 
try:: 
{:: 
obj;; 
.;; 
in_orgid;; $
=;;% &

eachorgobj;;' 1
.;;1 2
OrgID;;2 7
;;;7 8
MySqlParameter<< &
[<<& '
]<<' (
objParam<<) 1
=<<2 3
Util<<4 8
.<<8 9
GetParameter<<9 E
(<<E F
obj<<F I
)<<I J
;<<J K
_logger== 
.==  
LogInformation==  .
(==. /
string==/ 5
.==5 6
Format==6 <
(==< =
$str=== w
,==w x
this>> 
.>> 
GetType>> $
(>>$ %
)>>% &
.>>& '
Name>>' +
,>>+ ,
System>>- 3
.>>3 4

Reflection>>4 >
.>>> ?

MethodBase>>? I
.>>I J
GetCurrentMethod>>J Z
(>>Z [
)>>[ \
.>>\ ]
Name>>] a
,>>a b
DateTime??  
.??  !
Now??! $
)??$ %
)??% &
;??& '
var@@ 
resultEarlyCheckout@@ /
=@@0 1
await@@2 7
this@@8 <
.@@< =
sqldatahelper@@= J
.@@J K
ExecuteDataSet@@K Y
(@@Y Z
Util@@Z ^
.@@^ _
CS@@_ a
(@@a b
env@@b e
)@@e f
,@@f g
Constant@@h p
.@@p q'
nex_process_early_checkout	@@q ã
,
@@ã å
CommandType
@@ç ò
.
@@ò ô
StoredProcedure
@@ô ®
,
@@® ©
objParam
@@™ ≤
,
@@≤ ≥
_logger
@@¥ ª
)
@@ª º
.
@@º Ω
ToListAsync
@@Ω »
<
@@» …!
EarlyCheckOutResult
@@… ‹
>
@@‹ ›
(
@@› ﬁ
)
@@ﬁ ﬂ
;
@@ﬂ ‡
ListAA 
<AA 
EarlyCheckOutResultAA 0
>AA0 1 
earlyCheckoutListObjAA2 F
=AAG H
newAAI L
ListAAM Q
<AAQ R
EarlyCheckOutResultAAR e
>AAe f
(AAf g
)AAg h
;AAh i
_loggerBB 
.BB  
LogInformationBB  .
(BB. /
stringBB/ 5
.BB5 6
FormatBB6 <
(BB< =
$strBB= u
,BBu v
thisCC 
.CC 
GetTypeCC $
(CC$ %
)CC% &
.CC& '
NameCC' +
,CC+ ,
SystemCC- 3
.CC3 4

ReflectionCC4 >
.CC> ?

MethodBaseCC? I
.CCI J
GetCurrentMethodCCJ Z
(CCZ [
)CC[ \
.CC\ ]
NameCC] a
,CCa b
DateTimeDD  
.DD  !
NowDD! $
)DD$ %
)DD% &
;DD& ' 
earlyCheckoutListObjEE ,
.EE, -
AddRangeEE- 5
(EE5 6
resultEarlyCheckoutEE6 I
)EEI J
;EEJ K
foreachFF 
(FF  !
varFF! $ 
eachearlycheckoutobjFF% 9
inFF: < 
earlyCheckoutListObjFF= Q
)FFQ R
{FFS T
tryGG 
{HH 
EarlyCheckOutResultII  3
earlycheckoutobjII4 D
=IIE F 
eachearlycheckoutobjIIG [
;II[ \(
EarlyCheckOutResultParameterKK  <
paramKK= B
=KKC D
newKKE H(
EarlyCheckOutResultParameterKKI e
(KKe f
)KKf g
;KKg h
UtilLL  $
.LL$ %
CopyPropertiesFromLL% 7
(LL7 8
paramLL8 =
,LL= >
earlycheckoutobjLL? O
)LLO P
;LLP Q
MySqlParameterNN  .
[NN. /
]NN/ 0
paramEarlyCheckOutNN1 C
=NND E
UtilNNF J
.NNJ K
GetParameterNNK W
(NNW X
paramNNX ]
)NN] ^
;NN^ _
_loggerOO  '
.OO' (
LogInformationOO( 6
(OO6 7
stringOO7 =
.OO= >
FormatOO> D
(OOD E
$strOOE n
,OOn o
thisPP  $
.PP$ %
GetTypePP% ,
(PP, -
)PP- .
.PP. /
NamePP/ 3
,PP3 4
SystemPP5 ;
.PP; <

ReflectionPP< F
.PPF G

MethodBasePPG Q
.PPQ R
GetCurrentMethodPPR b
(PPb c
)PPc d
.PPd e
NamePPe i
,PPi j
DateTimeQQ  (
.QQ( )
NowQQ) ,
)QQ, -
)QQ- .
;QQ. /
awaitRR  %
thisRR& *
.RR* +
sqldatahelperRR+ 8
.RR8 9
ExecuteNonQueryRR9 H
(RRH I
UtilRRI M
.RRM N
CSRRN P
(RRP Q
envRRQ T
)RRT U
,RRU V
ConstantRRW _
.RR_ `$
nex_save_early_checkoutsRR` x
,RRx y
CommandType	RRz Ö
.
RRÖ Ü
StoredProcedure
RRÜ ï
,
RRï ñ
	parameter
RRó †
,
RR† °
_logger
RR¢ ©
)
RR© ™
;
RR™ ´
_loggerSS  '
.SS' (
LogInformationSS( 6
(SS6 7
stringSS7 =
.SS= >
FormatSS> D
(SSD E
$strSSE l
,SSl m
thisTT  $
.TT$ %
GetTypeTT% ,
(TT, -
)TT- .
.TT. /
NameTT/ 3
,TT3 4
SystemTT5 ;
.TT; <

ReflectionTT< F
.TTF G

MethodBaseTTG Q
.TTQ R
GetCurrentMethodTTR b
(TTb c
)TTc d
.TTd e
NameTTe i
,TTi j
DateTimeUU  (
.UU( )
NowUU) ,
)UU, -
)UU- .
;UU. /
}VV 
catchWW !
(WW" #
	ExceptionWW# ,
eWW- .
)WW. /
{WW0 1
_loggerXX  '
.XX' (
LogCriticalXX( 3
(XX3 4
stringXX4 :
.XX: ;
FormatXX; A
(XXA B
$str	XXB †
,
XX† °
thisYY  $
.YY$ %
GetTypeYY% ,
(YY, -
)YY- .
.YY. /
NameYY/ 3
,YY3 4
SystemYY5 ;
.YY; <

ReflectionYY< F
.YYF G

MethodBaseYYG Q
.YYQ R
GetCurrentMethodYYR b
(YYb c
)YYc d
.YYd e
NameYYe i
,YYi j

eachorgobjYYk u
.YYu v
OrgIDYYv {
,ZZ  !
DateTimeZZ" *
.ZZ* +
NowZZ+ .
,ZZ. /
eZZ0 1
.ZZ1 2
MessageZZ2 9
)ZZ9 :
)ZZ: ;
;ZZ; <
}[[ 
}\\ 
}]] 
catch^^ 
(^^ 
	Exception^^ #
e^^$ %
)^^% &
{__ 
_logger`` 
.``  
LogCritical``  +
(``+ ,
string``, 2
.``2 3
Format``3 9
(``9 :
$str``: {
,``{ |
thisaa 
.aa 
GetTypeaa $
(aa$ %
)aa% &
.aa& '
Nameaa' +
,aa+ ,
Systemaa- 3
.aa3 4

Reflectionaa4 >
.aa> ?

MethodBaseaa? I
.aaI J
GetCurrentMethodaaJ Z
(aaZ [
)aa[ \
.aa\ ]
Nameaa] a
,aaa b

eachorgobjaac m
.aam n
OrgIDaan s
,bb 
DateTimebb "
.bb" #
Nowbb# &
,bb& '
ebb( )
.bb) *
Messagebb* 1
)bb1 2
)bb2 3
;bb3 4
}cc 
}dd 
}ee 
catchff 
(ff 
	Exceptionff 
eff 
)ff 
{gg 
_loggerhh 
.hh 
LogCriticalhh #
(hh# $
stringhh$ *
.hh* +
Formathh+ 1
(hh1 2
$strhh2 l
,hhl m
thisii 
.ii 
GetTypeii  
(ii  !
)ii! "
.ii" #
Nameii# '
,ii' (
Systemii) /
.ii/ 0

Reflectionii0 :
.ii: ;

MethodBaseii; E
.iiE F
GetCurrentMethodiiF V
(iiV W
)iiW X
.iiX Y
NameiiY ]
,jj 
DateTimejj 
.jj 
Nowjj 
,jj 
ejj  !
.jj! "
Messagejj" )
)jj) *
)jj* +
;jj+ ,
throwkk 
ekk 
;kk 
}ll 
}mm 	
}nn 
}oo —$
rD:\Project\NexAEI\nexpcf.api.logger\nexpcf.api\nexpcf.api\Core.Consumer.API\Consumers\AttendanceSummaryConsumer.cs
	namespace 	
Core
 
. 
Consumer 
. 
API 
. 
	Consumers %
{ 
public 

class %
AttendanceSummaryConsumer *
:+ ,
IBaseConsumer- :
{ 
private 
readonly 
ILogger  
<  !
BaseConsumer! -
>- .
_logger/ 6
;6 7
public %
AttendanceSummaryConsumer (
(( )
ILogger) 0
<0 1
BaseConsumer1 =
>= >
logger? E
)E F
{ 	
_logger 
= 
logger 
; 
} 	
public 
async 
Task 
ConsumeAutoProcess ,
(, -
ConsumeContext- ;
<; <
SerializedJson< J
>J K
jsonL P
)P Q
{ 	

SummaryRef 
data 
= 
Utility %
.% &
Deserialize& 1
<1 2

SummaryRef2 <
>< =
(= >
json> B
.B C
MessageC J
.J K
JsonDataK S
)S T
;T U
_logger 
. 
LogInformation "
(" #
string# )
.) *
Format* 0
(0 1
$str1 m
,m n
this   
.   
GetType   
(   
)   
.   
Name   
,    
System  ! '
.  ' (

Reflection  ( 2
.  2 3

MethodBase  3 =
.  = >
GetCurrentMethod  > N
(  N O
)  O P
.  P Q
Name  Q U
,  U V
DateTime!! 
.!! 
Now!! 
,!! 
data!! 
)!! 
)!!  
;!!  !
if"" 
("" 
data"" 
."" 
objectid"" 
>"" 
$num""  !
)""! "
{## 
using$$ 
($$ $
AttendanceSummaryManager$$ /

objManager$$0 :
=$$; <
new$$= @$
AttendanceSummaryManager$$A Y
($$Y Z
_logger$$Z a
)$$a b
)$$b c
{%% 
_logger&& 
.&& 
LogInformation&& *
(&&* +
string&&+ 1
.&&1 2
Format&&2 8
(&&8 9
$str&&9 g
,&&g h
this'' 
.'' 
GetType''  
(''  !
)''! "
.''" #
Name''# '
,''' (
System'') /
.''/ 0

Reflection''0 :
.'': ;

MethodBase''; E
.''E F
GetCurrentMethod''F V
(''V W
)''W X
.''X Y
Name''Y ]
,''] ^
DateTime(( 
.(( 
Now((  
,((  !
data((" &
)((& '
)((' (
;((( )
await)) 

objManager)) $
.))$ %0
$generateAttendanceSummaryAutoProcess))% I
())I J
)))J K
;))K L
_logger** 
.** 
LogInformation** *
(*** +
string**+ 1
.**1 2
Format**2 8
(**8 9
$str**9 f
,**f g
this++ 
.++ 
GetType++  
(++  !
)++! "
.++" #
Name++# '
,++' (
System++) /
.++/ 0

Reflection++0 :
.++: ;

MethodBase++; E
.++E F
GetCurrentMethod++F V
(++V W
)++W X
.++X Y
Name++Y ]
,++] ^
DateTime,, 
.,, 
Now,,  
,,,  !
data,," &
),,& '
),,' (
;,,( )
}-- 
}.. 
_logger// 
.// 
LogInformation// "
(//" #
string//# )
.//) *
Format//* 0
(//0 1
$str//1 m
,//m n
this00 
.00 
GetType00 
(00 
)00 
.00 
Name00 
,00  
System00! '
.00' (

Reflection00( 2
.002 3

MethodBase003 =
.00= >
GetCurrentMethod00> N
(00N O
)00O P
.00P Q
Name00Q U
,00U V
DateTime11 
.11 
Now11 
,11 
data11 
)11 
)11  
;11  !
}88 	
}99 
}:: Ω%
eD:\Project\NexAEI\nexpcf.api.logger\nexpcf.api\nexpcf.api\Core.Consumer.API\Consumers\BaseConsumer.cs
	namespace

 	
Core


 
.

 
Consumer

 
.

 
API

 
.

 
	Consumers

 %
{ 
public 

class 
BaseConsumer 
: 
	IConsumer  )
<) *
SerializedJson* 8
>8 9
{ 
private 
readonly 
ILogger  
<  !
BaseConsumer! -
>- .
_logger/ 6
;6 7
public 
BaseConsumer 
( 
ILogger #
<# $
BaseConsumer$ 0
>0 1
logger2 8
)8 9
{ 	
_logger 
= 
logger 
; 
} 	
public 
async 
Task 
Consume !
(! "
ConsumeContext" 0
<0 1
SerializedJson1 ?
>? @
contextA H
)H I
{ 	
_logger 
. 
LogInformation "
(" #
string# )
.) *
Format* 0
(0 1
$str1 b
,b c
this 
. 
GetType 
( 
) 
. 
Name 
,  
System! '
.' (

Reflection( 2
.2 3

MethodBase3 =
.= >
GetCurrentMethod> N
(N O
)O P
.P Q
NameQ U
,U V
DateTime 
. 
Now 
, 
context !
)! "
)" #
;# $
switch 
( 
context 
. 
Message #
.# $
consumer$ ,
), -
{ 
case 
TargetConsumer #
.# $%
AttendanceSummaryConsumer$ =
:= >
_logger 
. 
LogInformation *
(* +
string+ 1
.1 2
Format2 8
(8 9
$str9 [
,[ \
this 
. 
GetType  
(  !
)! "
." #
Name# '
,' (
System) /
./ 0

Reflection0 :
.: ;

MethodBase; E
.E F
GetCurrentMethodF V
(V W
)W X
.X Y
NameY ]
,] ^
DateTime 
. 
Now  
,  !
context" )
)) *
)* +
;+ ,
await   
new   %
AttendanceSummaryConsumer   7
(  7 8
_logger  8 ?
)  ? @
.  @ A
ConsumeAutoProcess  A S
(  S T
context  T [
)  [ \
;  \ ]
break!! 
;!! 
case"" 
TargetConsumer"" #
.""# $!
EarlyCheckOutConsumer""$ 9
:""9 :
_logger## 
.## 
LogInformation## *
(##* +
string##+ 1
.##1 2
Format##2 8
(##8 9
$str##9 Z
,##Z [
this$$ 
.$$ 
GetType$$  
($$  !
)$$! "
.$$" #
Name$$# '
,$$' (
System$$) /
.$$/ 0

Reflection$$0 :
.$$: ;

MethodBase$$; E
.$$E F
GetCurrentMethod$$F V
($$V W
)$$W X
.$$X Y
Name$$Y ]
,$$] ^
DateTime%% 
.%% 
Now%%  
,%%  !
context%%" )
)%%) *
)%%* +
;%%+ ,
await&& 
new&& !
EarlyCheckOutConsumer&& 3
(&&3 4
_logger&&4 ;
)&&; <
.&&< =
ConsumeAutoProcess&&= O
(&&O P
context&&P W
)&&W X
;&&X Y
break'' 
;'' 
default(( 
:(( 
break)) 
;)) 
}** 
_logger++ 
.++ 
LogInformation++ "
(++" #
string++# )
.++) *
Format++* 0
(++0 1
$str++1 [
,++[ \
this,, 
.,, 
GetType,, 
(,, 
),, 
.,, 
Name,, 
,,,  
System,,! '
.,,' (

Reflection,,( 2
.,,2 3

MethodBase,,3 =
.,,= >
GetCurrentMethod,,> N
(,,N O
),,O P
.,,P Q
Name,,Q U
,,,U V
DateTime-- 
.-- 
Now-- 
)-- 
)-- 
;-- 
}.. 	
}// 
}00 ¡
nD:\Project\NexAEI\nexpcf.api.logger\nexpcf.api\nexpcf.api\Core.Consumer.API\Consumers\EarlyCheckOutConsumer.cs
	namespace 	
Core
 
. 
Consumer 
. 
API 
. 
	Consumers %
{ 
public 

class !
EarlyCheckOutConsumer &
:' (
IBaseConsumer) 6
{ 
private 
readonly 
ILogger  
<  !
BaseConsumer! -
>- .
_logger/ 6
;6 7
public !
EarlyCheckOutConsumer $
($ %
ILogger% ,
<, -
BaseConsumer- 9
>9 :
logger; A
)A B
{ 	
_logger 
= 
logger 
; 
} 	
public 
async 
Task 
ConsumeAutoProcess ,
(, -
ConsumeContext- ;
<; <
SerializedJson< J
>J K
jsonL P
)P Q
{ 	

SummaryRef 
data 
= 
Utility %
.% &
Deserialize& 1
<1 2

SummaryRef2 <
>< =
(= >
json> B
.B C
MessageC J
.J K
JsonDataK S
)S T
;T U
if   
(   
data   
.   
objectid   
>   
$num    !
)  ! "
{!! 
using"" 
(""  
EarlyCheckOutManager"" +

objManager"", 6
=""7 8
new""9 < 
EarlyCheckOutManager""= Q
(""Q R
_logger""R Y
)""Y Z
)""Z [
{## 
await$$ 

objManager$$ $
.$$$ % 
processEarlyCheckOut$$% 9
($$9 :
)$$: ;
;$$; <
}%% 
}&& 
}-- 	
}.. 
}// ”
fD:\Project\NexAEI\nexpcf.api.logger\nexpcf.api\nexpcf.api\Core.Consumer.API\Consumers\IBaseConsumer.cs
	namespace 	
Core
 
. 
Consumer 
. 
API 
. 
	Consumers %
{		 
public

 

	interface

 
IBaseConsumer

 "
{ 
public 
Task 
ConsumeAutoProcess &
(& '
ConsumeContext' 5
<5 6
SerializedJson6 D
>D E
jsonF J
)J K
;K L
} 
} ¯
lD:\Project\NexAEI\nexpcf.api.logger\nexpcf.api\nexpcf.api\Core.Consumer.API\Controllers\DefaultController.cs
	namespace 	
Core
 
. 
Consumer 
. 
API 
. 
Controllers '
{		 
[

 
Route

 

(


 
$str

 
)

 
]

 
[ 
ApiController 
] 
public 

class 
DefaultController "
:# $
ControllerBase% 3
{ 
[ 	
HttpGet	 
] 
public 
IActionResult 
GetAPIStatus )
() *
)* +
{ 	
return 
Ok 
( 
new 
{ 
success #
=$ %
$num& '
,' (
message) 0
=1 2
$str3 X
}Y Z
)Z [
;[ \
} 	
} 
} Ì

VD:\Project\NexAEI\nexpcf.api.logger\nexpcf.api\nexpcf.api\Core.Consumer.API\Program.cs
	namespace

 	
Core


 
.

 
Consumer

 
.

 
API

 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} È(
VD:\Project\NexAEI\nexpcf.api.logger\nexpcf.api\nexpcf.api\Core.Consumer.API\Startup.cs
	namespace 	
Core
 
. 
Consumer 
. 
API 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
services 
. 
AddMassTransit #
(# $
x$ %
=>& (
{   
x!! 
.!! 
AddConsumer!! 
<!! 
BaseConsumer!! *
>!!* +
(!!+ ,
)!!, -
;!!- .
x"" 
."" 
AddBus"" 
("" 
provider"" !
=>""" $
Bus""% (
.""( )
Factory"") 0
.""0 1
CreateUsingRabbitMq""1 D
(""D E
cfg""E H
=>""I K
{## 
cfg$$ 
.$$ 
UseHealthCheck$$ &
($$& '
provider$$' /
)$$/ 0
;$$0 1
cfg%% 
.%% 
Host%% 
(%% 
$str%% n
,%%n o
h%%p q
=>%%r t
{&& 
h'' 
.'' 
Username'' "
(''" #
$str''# *
)''* +
;''+ ,
h(( 
.(( 
Password(( "
(((" #
$str((# 2
)((2 3
;((3 4
})) 
))) 
;)) 
cfg** 
.** 
ReceiveEndpoint** '
(**' (
$str**( @
,**@ A
ep**B D
=>**E G
{++ 
ep,, 
.,, 
PrefetchCount,, (
=,,) *
$num,,+ ,
;,,, -
ep.. 
... 
ConfigureConsumer.. ,
<.., -
BaseConsumer..- 9
>..9 :
(..: ;
provider..; C
)..C D
;..D E
}// 
)// 
;// 
}00 
)00 
)00 
;00 
}11 
)11 
;11 
servicesGG 
.GG '
AddMassTransitHostedServiceGG 0
(GG0 1
)GG1 2
;GG2 3
servicesHH 
.HH 
AddControllersHH #
(HH# $
)HH$ %
;HH% &
}II 	
publicLL 
voidLL 
	ConfigureLL 
(LL 
IApplicationBuilderLL 1
appLL2 5
,LL5 6
IWebHostEnvironmentLL7 J
envLLK N
,LLN O
ILoggerFactoryLLP ^
loggerFactoryLL_ l
)LLl m
{MM 	
ifPP 
(PP 
RuntimeInformationPP "
.PP" #
IsOSPlatformPP# /
(PP/ 0

OSPlatformPP0 :
.PP: ;
WindowsPP; B
)PPB C
)PPC D
{QQ 
loggerFactoryRR 
.RR 
AddFileRR %
(RR% &
stringRR& ,
.RR, -
FormatRR- 3
(RR3 4
$strRR4 <
,RR< =
ConfigurationRR> K
.RRK L

GetSectionRRL V
(RRV W
$strRRW d
)RRd e
[RRe f
$strRRf z
]RRz {
,RR{ |
$str	RR} Ü
)
RRÜ á
)
RRá à
;
RRà â
}SS 
elseTT 
ifTT 
(TT 
RuntimeInformationTT '
.TT' (
IsOSPlatformTT( 4
(TT4 5

OSPlatformTT5 ?
.TT? @
LinuxTT@ E
)TTE F
)TTF G
{UU 
loggerFactoryVV 
.VV 
AddFileVV %
(VV% &
stringVV& ,
.VV, -
FormatVV- 3
(VV3 4
$strVV4 <
,VV< =
ConfigurationVV> K
.VVK L

GetSectionVVL V
(VVV W
$strVVW d
)VVd e
[VVe f
$strVVf x
]VVx y
,VVy z
$str	VV{ Ñ
)
VVÑ Ö
)
VVÖ Ü
;
VVÜ á
}WW 
ifYY 
(YY 
envYY 
.YY 
IsDevelopmentYY !
(YY! "
)YY" #
)YY# $
{ZZ 
app[[ 
.[[ %
UseDeveloperExceptionPage[[ -
([[- .
)[[. /
;[[/ 0
}\\ 
app^^ 
.^^ 

UseRouting^^ 
(^^ 
)^^ 
;^^ 
app`` 
.`` 
UseAuthorization``  
(``  !
)``! "
;``" #
appbb 
.bb 
UseEndpointsbb 
(bb 
	endpointsbb &
=>bb' )
{cc 
	endpointsdd 
.dd 
MapControllersdd (
(dd( )
)dd) *
;dd* +
}ee 
)ee 
;ee 
}ff 	
}gg 
}hh Ç
]D:\Project\NexAEI\nexpcf.api.logger\nexpcf.api\nexpcf.api\Core.Consumer.API\Utils\Constant.cs
	namespace 	
Core
 
. 
Consumer 
. 
API 
. 
Utils !
{ 
internal 
static 
class 
Constant "
{ 
internal 
static 
string 
nex_get_orgs +
=, -
$str. <
;< =
internal 
static 
string 
nex_get_orgs_users 1
=2 3
$str4 H
;H I
internal 
static 
string *
nex_generate_attendance_status =
=> ?
$str@ `
;` a
internal 
static 
string *
nex_re_gen_delta_modified_data =
=> ?
$str@ `
;` a
internal		 
static		 
string		 &
nex_save_attendance_status		 9
=		: ;
$str		< X
;		X Y
internal

 
static

 
string

 &
nex_process_early_checkout

 9
=

: ;
$str

< X
;

X Y
internal 
static 
string $
nex_save_early_checkouts 7
=8 9
$str: T
;T U
} 
} ˚
\D:\Project\NexAEI\nexpcf.api.logger\nexpcf.api\nexpcf.api\Core.Consumer.API\Utils\Utility.cs
	namespace 	
Core
 
. 
Consumer 
. 
API 
. 
Utils !
{ 
public		 

static		 
class		 
Utility		 
{

 
public 
static 
T 
Deserialize #
<# $
T$ %
>% &
(& '
string' -
json. 2
)2 3
{ 	
T 
objectResult 
= 
JsonConvert (
.( )
DeserializeObject) :
<: ;
T; <
>< =
(= >
json> B
)B C
;C D
return 
objectResult 
;  
} 	
} 
} 